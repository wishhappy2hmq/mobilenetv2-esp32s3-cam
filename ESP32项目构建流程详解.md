# ESP32é¡¹ç›®æ„å»ºæµç¨‹è¯¦è§£

## ğŸ“š ç›®å½•

1. [é¡¹ç›®ç»“æ„æ€»è§ˆ](#é¡¹ç›®ç»“æ„æ€»è§ˆ)
2. [æ„å»ºæµç¨‹è¯¦è§£](#æ„å»ºæµç¨‹è¯¦è§£)
3. [é‡è¦æ–‡ä»¶å’Œç›®å½•](#é‡è¦æ–‡ä»¶å’Œç›®å½•)
4. [å¸¸ç”¨å‘½ä»¤è¯¦è§£](#å¸¸ç”¨å‘½ä»¤è¯¦è§£)
5. [æ„å»ºè¿‡ç¨‹å¯è§†åŒ–](#æ„å»ºè¿‡ç¨‹å¯è§†åŒ–)

---

## é¡¹ç›®ç»“æ„æ€»è§ˆ

### æœ€å°ESP32é¡¹ç›®ç»“æ„

```
my_project/
â”œâ”€â”€ CMakeLists.txt           # é¡¹ç›®çº§CMakeé…ç½®
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ CMakeLists.txt       # ä¸»ç»„ä»¶CMakeé…ç½®
â”‚   â””â”€â”€ app_main.c           # ä¸»ç¨‹åºå…¥å£
â””â”€â”€ (build/)                 # ç¼–è¯‘åè‡ªåŠ¨ç”Ÿæˆ
```

### å®Œæ•´é¡¹ç›®ç»“æ„ï¼ˆç¼–è¯‘åï¼‰

```
my_project/
â”œâ”€â”€ CMakeLists.txt
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ CMakeLists.txt
â”‚   â”œâ”€â”€ app_main.c
â”‚   â””â”€â”€ idf_component.yml    # ç»„ä»¶ä¾èµ–ï¼ˆå¯é€‰ï¼‰
â”‚
â”œâ”€â”€ components/              # è‡ªå®šä¹‰ç»„ä»¶ï¼ˆå¯é€‰ï¼‰
â”‚   â””â”€â”€ my_component/
â”‚       â”œâ”€â”€ CMakeLists.txt
â”‚       â””â”€â”€ my_component.c
â”‚
â”œâ”€â”€ sdkconfig                # é…ç½®æ–‡ä»¶ï¼ˆmenuconfigåç”Ÿæˆï¼‰
â”œâ”€â”€ sdkconfig.defaults       # é»˜è®¤é…ç½®ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ partitions.csv           # åˆ†åŒºè¡¨ï¼ˆå¯é€‰ï¼‰
â”‚
â””â”€â”€ build/                   # â­ ç¼–è¯‘è¾“å‡ºç›®å½•
    â”œâ”€â”€ bootloader/          # BootloaderäºŒè¿›åˆ¶æ–‡ä»¶
    â”œâ”€â”€ partition_table/     # åˆ†åŒºè¡¨äºŒè¿›åˆ¶æ–‡ä»¶
    â”œâ”€â”€ esp-idf/             # ESP-IDFç»„ä»¶ç¼–è¯‘è¾“å‡º
    â”œâ”€â”€ main/                # ä¸»ç»„ä»¶ç¼–è¯‘è¾“å‡º
    â”œâ”€â”€ *.bin                # æœ€ç»ˆå›ºä»¶æ–‡ä»¶
    â”œâ”€â”€ *.elf                # ELFå¯æ‰§è¡Œæ–‡ä»¶
    â”œâ”€â”€ *.map                # å†…å­˜æ˜ å°„æ–‡ä»¶
    â”œâ”€â”€ compile_commands.json # ç¼–è¯‘å‘½ä»¤æ•°æ®åº“
    â”œâ”€â”€ CMakeCache.txt       # CMakeç¼“å­˜
    â””â”€â”€ flash_project_args   # çƒ§å½•å‚æ•°
```

---

## æ„å»ºæµç¨‹è¯¦è§£

### å®Œæ•´æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     1. é¡¹ç›®åˆå§‹åŒ–                            â”‚
â”‚                   idf.py set-target esp32s3                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”Ÿæˆ sdkconfig å’Œ build/ ç›®å½•                               â”‚
â”‚  - æ£€æµ‹ç›®æ ‡èŠ¯ç‰‡                                              â”‚
â”‚  - åˆ›å»ºé»˜è®¤é…ç½®                                              â”‚
â”‚  - åˆå§‹åŒ–CMakeç¯å¢ƒ                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     2. é…ç½®é˜¶æ®µï¼ˆå¯é€‰ï¼‰                      â”‚
â”‚                     idf.py menuconfig                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰“å¼€é…ç½®ç•Œé¢ï¼Œä¿®æ”¹å‚æ•°                                       â”‚
â”‚  - WiFié…ç½®                                                  â”‚
â”‚  - PSRAMé…ç½®                                                 â”‚
â”‚  - åˆ†åŒºè¡¨é…ç½®                                                â”‚
â”‚  - ç»„ä»¶é…ç½®ç­‰                                                â”‚
â”‚  ä¿å­˜åæ›´æ–° sdkconfig                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     3. CMakeé…ç½®é˜¶æ®µ                         â”‚
â”‚                     idf.py reconfigure                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CMakeå¤„ç†é…ç½®æ–‡ä»¶                                            â”‚
â”‚  1. è¯»å– CMakeLists.txt                                      â”‚
â”‚  2. è§£æç»„ä»¶ä¾èµ–                                              â”‚
â”‚  3. ç”Ÿæˆæ„å»ºç³»ç»Ÿæ–‡ä»¶                                          â”‚
â”‚  4. åˆ›å»º build/CMakeCache.txt                                â”‚
â”‚  5. ç”Ÿæˆ build/compile_commands.json                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     4. ç¼–è¯‘é˜¶æ®µ                              â”‚
â”‚                     idf.py build                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4.1 ç¼–è¯‘Bootloader                                          â”‚
â”‚      â†’ build/bootloader/bootloader.bin                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4.2 ç¼–è¯‘åˆ†åŒºè¡¨                                              â”‚
â”‚      â†’ build/partition_table/partition-table.bin             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4.3 ç¼–è¯‘ESP-IDFç»„ä»¶                                         â”‚
â”‚      - esp_wifi                                              â”‚
â”‚      - esp_http_server                                       â”‚
â”‚      - esp_camera                                            â”‚
â”‚      - nvs_flash                                             â”‚
â”‚      - freertos                                              â”‚
â”‚      - ... (å‡ åä¸ªç»„ä»¶)                                       â”‚
â”‚      â†’ build/esp-idf/*/lib*.a (é™æ€åº“)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4.4 ç¼–è¯‘ç”¨æˆ·ç»„ä»¶                                            â”‚
â”‚      - mainç»„ä»¶                                              â”‚
â”‚      - imagenet_clsç»„ä»¶                                      â”‚
â”‚      - è‡ªå®šä¹‰ç»„ä»¶                                            â”‚
â”‚      â†’ build/main/libmain.a                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4.5 é“¾æ¥é˜¶æ®µ                                                â”‚
â”‚      å°†æ‰€æœ‰ .a å’Œ .o æ–‡ä»¶é“¾æ¥æˆæœ€ç»ˆå›ºä»¶                      â”‚
â”‚      â†’ build/project_name.elf                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4.6 ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶                                          â”‚
â”‚      ä» .elf æå–å¯çƒ§å½•çš„äºŒè¿›åˆ¶æ–‡ä»¶                          â”‚
â”‚      â†’ build/project_name.bin                                â”‚
â”‚      â†’ build/project_name.map (å†…å­˜æ˜ å°„)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     5. çƒ§å½•é˜¶æ®µ                              â”‚
â”‚                     idf.py flash                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä½¿ç”¨ esptool.py çƒ§å½•åˆ°Flash                                 â”‚
â”‚  1. çƒ§å½• bootloader.bin â†’ 0x0                                â”‚
â”‚  2. çƒ§å½• partition-table.bin â†’ 0x8000                        â”‚
â”‚  3. çƒ§å½• project_name.bin â†’ 0x10000                          â”‚
â”‚  4. çƒ§å½•å…¶ä»–åˆ†åŒºï¼ˆå¦‚OTAã€NVSç­‰ï¼‰                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     6. ç›‘æ§é˜¶æ®µ                              â”‚
â”‚                     idf.py monitor                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰“å¼€ä¸²å£ç›‘è§†å™¨ï¼ŒæŸ¥çœ‹è¾“å‡ºæ—¥å¿—                                 â”‚
â”‚  - è‡ªåŠ¨è§£æå †æ ˆè·Ÿè¸ª                                          â”‚
â”‚  - æ˜¾ç¤ºé¢œè‰²æ—¥å¿—                                              â”‚
â”‚  - æ”¯æŒå¿«æ·é”®æ“ä½œ                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é‡è¦æ–‡ä»¶å’Œç›®å½•

### 1. é¡¹ç›®æ ¹ç›®å½•æ–‡ä»¶

#### CMakeLists.txtï¼ˆé¡¹ç›®çº§ï¼‰

```cmake
# æœ€å°ç‰ˆæœ¬è¦æ±‚
cmake_minimum_required(VERSION 3.5)

# åŒ…å«ESP-IDFæ„å»ºç³»ç»Ÿ
include($ENV{IDF_PATH}/tools/cmake/project.cmake)

# å®šä¹‰é¡¹ç›®åç§°
project(my_project)
```

**ä½œç”¨**ï¼š
- å®šä¹‰é¡¹ç›®åç§°å’Œç‰ˆæœ¬
- å¼•å…¥ESP-IDFæ„å»ºç³»ç»Ÿ
- è®¾ç½®å…¨å±€ç¼–è¯‘é€‰é¡¹

#### sdkconfig

```ini
# è‡ªåŠ¨ç”Ÿæˆçš„é…ç½®æ–‡ä»¶
CONFIG_IDF_TARGET="esp32s3"
CONFIG_ESP32S3_DEFAULT_CPU_FREQ_240=y
CONFIG_SPIRAM=y
CONFIG_COMPILER_OPTIMIZATION_PERF=y
# ... å‡ åƒè¡Œé…ç½®
```

**ä½œç”¨**ï¼š
- å­˜å‚¨æ‰€æœ‰é…ç½®é€‰é¡¹
- ç”± `idf.py menuconfig` ç”Ÿæˆ
- ç¼–è¯‘æ—¶è¯»å–è¿™äº›é…ç½®

#### sdkconfig.defaultsï¼ˆå¯é€‰ï¼‰

```ini
# é»˜è®¤é…ç½®ï¼Œç‰ˆæœ¬æ§åˆ¶å‹å¥½
CONFIG_IDF_TARGET="esp32s3"
CONFIG_ESPTOOLPY_FLASHSIZE_8MB=y
CONFIG_SPIRAM=y
```

**ä½œç”¨**ï¼š
- å®šä¹‰é»˜è®¤é…ç½®
- é€‚åˆçº³å…¥ç‰ˆæœ¬æ§åˆ¶ï¼ˆsdkconfigå¤ªå¤§ä¸é€‚åˆï¼‰
- é¦–æ¬¡æ„å»ºæˆ– `fullclean` åä½œä¸ºåˆå§‹é…ç½®

---

### 2. mainç›®å½•ï¼ˆä¸»ç»„ä»¶ï¼‰

#### main/CMakeLists.txt

```cmake
idf_component_register(
    SRCS "app_main.c"               # æºæ–‡ä»¶åˆ—è¡¨
    INCLUDE_DIRS "."                # å¤´æ–‡ä»¶ç›®å½•
    REQUIRES esp_wifi nvs_flash     # ä¾èµ–çš„ç»„ä»¶
)
```

**ä½œç”¨**ï¼š
- å®šä¹‰ç»„ä»¶çš„æºæ–‡ä»¶
- æŒ‡å®šå¤´æ–‡ä»¶ç›®å½•
- å£°æ˜ç»„ä»¶ä¾èµ–

#### main/idf_component.ymlï¼ˆå¯é€‰ï¼‰

```yaml
dependencies:
  espressif/esp32-camera: "^2.0.0"
  my_local_component:
    path: "../components/my_component"
```

**ä½œç”¨**ï¼š
- ä½¿ç”¨ç»„ä»¶ç®¡ç†å™¨ç®¡ç†å¤–éƒ¨ä¾èµ–
- è‡ªåŠ¨ä¸‹è½½å’Œç®¡ç†ç»„ä»¶ç‰ˆæœ¬

---

### 3. buildç›®å½•è¯¦è§£

ç¼–è¯‘åè‡ªåŠ¨ç”Ÿæˆï¼Œ**ä¸è¦æ‰‹åŠ¨ä¿®æ”¹**ï¼Œå¯ä»¥åˆ é™¤é‡æ–°ç”Ÿæˆã€‚

```
build/
â”œâ”€â”€ bootloader/
â”‚   â”œâ”€â”€ bootloader.bin           # BootloaderäºŒè¿›åˆ¶æ–‡ä»¶
â”‚   â”œâ”€â”€ bootloader.elf           # Bootloader ELFæ–‡ä»¶
â”‚   â””â”€â”€ bootloader.map           # Bootloaderå†…å­˜æ˜ å°„
â”‚
â”œâ”€â”€ partition_table/
â”‚   â”œâ”€â”€ partition-table.bin      # åˆ†åŒºè¡¨äºŒè¿›åˆ¶
â”‚   â””â”€â”€ partitions.csv           # åˆ†åŒºè¡¨å®šä¹‰
â”‚
â”œâ”€â”€ esp-idf/
â”‚   â”œâ”€â”€ esp_wifi/
â”‚   â”‚   â””â”€â”€ libesp_wifi.a        # WiFié™æ€åº“
â”‚   â”œâ”€â”€ esp_http_server/
â”‚   â”‚   â””â”€â”€ libesp_http_server.a # HTTPæœåŠ¡å™¨é™æ€åº“
â”‚   â”œâ”€â”€ freertos/
â”‚   â”‚   â””â”€â”€ libfreertos.a        # FreeRTOSé™æ€åº“
â”‚   â””â”€â”€ ... (æ‰€æœ‰ESP-IDFç»„ä»¶)
â”‚
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ libmain.a                # ä¸»ç»„ä»¶é™æ€åº“
â”‚   â”œâ”€â”€ app_main.c.obj           # ç¼–è¯‘çš„ç›®æ ‡æ–‡ä»¶
â”‚   â””â”€â”€ CMakeFiles/              # CMakeä¸´æ—¶æ–‡ä»¶
â”‚
â”œâ”€â”€ my_project.elf               # ELFå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆåŒ…å«ç¬¦å·ï¼‰
â”œâ”€â”€ my_project.bin               # æœ€ç»ˆå›ºä»¶ï¼ˆå¯çƒ§å½•ï¼‰
â”œâ”€â”€ my_project.map               # å†…å­˜æ˜ å°„æ–‡ä»¶
â”‚
â”œâ”€â”€ CMakeCache.txt               # CMakeç¼“å­˜é…ç½®
â”œâ”€â”€ compile_commands.json        # ç¼–è¯‘å‘½ä»¤æ•°æ®åº“ï¼ˆIDEç”¨ï¼‰
â”œâ”€â”€ flash_project_args           # çƒ§å½•å‚æ•°
â”œâ”€â”€ flasher_args.json            # çƒ§å½•å™¨å‚æ•°ï¼ˆJSONæ ¼å¼ï¼‰
â”œâ”€â”€ project_description.json     # é¡¹ç›®æè¿°ä¿¡æ¯
â”‚
â””â”€â”€ log/
    â”œâ”€â”€ idf_py_stdout_output.txt # æ ‡å‡†è¾“å‡ºæ—¥å¿—
    â””â”€â”€ idf_py_stderr_output.txt # æ ‡å‡†é”™è¯¯æ—¥å¿—
```

---

## å¸¸ç”¨å‘½ä»¤è¯¦è§£

### 1. idf.py set-target esp32s3

**å‘ç”Ÿçš„äº‹æƒ…**ï¼š

```bash
$ idf.py set-target esp32s3

1. åˆ é™¤æ—§çš„ build/ ç›®å½•ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
2. åˆ›å»ºæ–°çš„ sdkconfig æ–‡ä»¶
   - è®¾ç½® CONFIG_IDF_TARGET="esp32s3"
   - åº”ç”¨ esp32s3 çš„é»˜è®¤é…ç½®
3. åˆå§‹åŒ– build/ ç›®å½•
4. è¿è¡Œ CMake é…ç½®
   - ç”Ÿæˆ CMakeCache.txt
   - æ£€æµ‹å·¥å…·é“¾
   - è§£æä¾èµ–å…³ç³»
```

**è¾“å‡ºç¤ºä¾‹**ï¼š

```
Deleting the existing 'build' directory...
Setting IDF_TARGET to esp32s3
Running cmake in directory /path/to/build
Executing "cmake -G Ninja -DPYTHON_DEPS_CHECKED=1 ..."
-- The C compiler identification is GNU 11.2.0
-- The CXX compiler identification is GNU 11.2.0
-- Configuring done
-- Generating done
-- Build files have been written to: /path/to/build
```

---

### 2. idf.py menuconfig

**å‘ç”Ÿçš„äº‹æƒ…**ï¼š

```bash
$ idf.py menuconfig

1. è¯»å–å½“å‰ sdkconfig
2. å¯åŠ¨åŸºäºncursesçš„é…ç½®ç•Œé¢
3. å…è®¸ç”¨æˆ·ä¿®æ”¹é…ç½®é€‰é¡¹
4. ä¿å­˜åæ›´æ–° sdkconfig
5. å¦‚æœæœ‰æ”¹åŠ¨ï¼Œè§¦å‘ CMake é‡æ–°é…ç½®
```

**é…ç½®ç•Œé¢ç»“æ„**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Espressif IoT Development Framework    â”‚
â”‚                                         â”‚
â”‚  â†’ Component config                     â”‚
â”‚  â†’ Build type                           â”‚
â”‚  â†’ Compiler options                     â”‚
â”‚  â†’ Component config                     â”‚
â”‚     â†’ ESP32S3-Specific                  â”‚
â”‚     â†’ ESP System Settings               â”‚
â”‚     â†’ Driver configurations             â”‚
â”‚        â†’ SPI configuration              â”‚
â”‚        â†’ UART configuration             â”‚
â”‚        â†’ I2C configuration              â”‚
â”‚     â†’ Wi-Fi                             â”‚
â”‚     â†’ FreeRTOS                          â”‚
â”‚     â†’ ... (æ›´å¤šç»„ä»¶)                     â”‚
â”‚                                         â”‚
â”‚  < Select >   < Exit >   < Help >      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å¸¸ç”¨é…ç½®é¡¹**ï¼š

| è·¯å¾„ | é…ç½®é¡¹ | è¯´æ˜ |
|------|--------|------|
| Component config â†’ ESP32S3-Specific | CPU frequency | è®¾ç½®CPUé¢‘ç‡ï¼ˆ240MHzï¼‰ |
| Component config â†’ ESP32S3-Specific | Support for external SPIRAM | å¯ç”¨PSRAM |
| Compiler options | Optimization Level | ä¼˜åŒ–çº§åˆ«ï¼ˆ-O2, -Os, -O3ï¼‰ |
| Partition Table | Partition Table | é€‰æ‹©åˆ†åŒºè¡¨ç±»å‹ |
| Serial flasher config | Flash size | Flashå¤§å°ï¼ˆ4MB, 8MBç­‰ï¼‰ |

---

### 3. idf.py build

**è¯¦ç»†æ­¥éª¤**ï¼š

```bash
$ idf.py build

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é˜¶æ®µ1: CMakeé…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  - æ£€æŸ¥ CMakeCache.txt æ˜¯å¦æœ‰æ•ˆ
  - å¦‚æœæ— æ•ˆæˆ–ä¸å­˜åœ¨ï¼Œè¿è¡Œ cmake é…ç½®
  - è¯»å– sdkconfig
  - è§£ææ‰€æœ‰ CMakeLists.txt
  - ç”Ÿæˆæ„å»ºè§„åˆ™

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é˜¶æ®µ2: ç¼–è¯‘Bootloader                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  [1/3] Building bootloader...
  [2/3] Linking bootloader.elf
  [3/3] Generating bootloader.bin

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é˜¶æ®µ3: ç¼–è¯‘åˆ†åŒºè¡¨                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  Generating partition-table.bin from partitions.csv

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é˜¶æ®µ4: ç¼–è¯‘æ‰€æœ‰ç»„ä»¶                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  [1/156] Building C object esp-idf/esp_wifi/...
  [2/156] Building C object esp-idf/freertos/...
  [3/156] Building C object main/...
  ...
  [155/156] Linking C static library libmain.a
  [156/156] Linking CXX executable project_name.elf

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é˜¶æ®µ5: é“¾æ¥å’Œç”Ÿæˆå›ºä»¶                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  Generating binary image from built executable
  esptool.py v4.5
  Creating esp32s3 image...
  Successfully created esp32s3 image.

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å®Œæˆï¼                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  Project build complete. To flash, run:
    idf.py flash
```

**ç¼–è¯‘äº§ç‰©**ï¼š

```
build/
â”œâ”€â”€ bootloader.bin          # 0x0
â”œâ”€â”€ partition-table.bin     # 0x8000
â”œâ”€â”€ project_name.bin        # 0x10000 (é»˜è®¤)
â”œâ”€â”€ project_name.elf        # ç”¨äºè°ƒè¯•ï¼ˆåŒ…å«ç¬¦å·ï¼‰
â””â”€â”€ project_name.map        # å†…å­˜ä½¿ç”¨æƒ…å†µ
```

---

### 4. idf.py flash

**å‘ç”Ÿçš„äº‹æƒ…**ï¼š

```bash
$ idf.py flash

1. æ£€æµ‹ä¸²å£
   - è‡ªåŠ¨æ‰«æ /dev/ttyUSB* æˆ– COM*
   - æˆ–ä½¿ç”¨ -p æŒ‡å®šç«¯å£

2. è¯»å–çƒ§å½•å‚æ•°
   - ä» build/flash_project_args è¯»å–
   - åŒ…å«åœ°å€å’Œæ–‡ä»¶æ˜ å°„

3. ä½¿ç”¨ esptool.py çƒ§å½•
   esptool.py --chip esp32s3 \
              --port /dev/ttyUSB0 \
              --baud 460800 \
              write_flash \
              0x0 bootloader.bin \
              0x8000 partition-table.bin \
              0x10000 project_name.bin

4. éªŒè¯çƒ§å½•
   - è¯»å›Flashå†…å®¹
   - æ ¡éªŒMD5
```

**è¾“å‡ºç¤ºä¾‹**ï¼š

```
esptool.py v4.5
Serial port /dev/ttyUSB0
Connecting....
Chip is ESP32-S3 (revision v0.1)
Features: WiFi, BLE
Crystal is 40MHz
MAC: 7c:df:a1:e0:00:01
Uploading stub...
Running stub...
Stub running...
Configuring flash size...
Flash will be erased from 0x00000000 to 0x00005fff...
Flash will be erased from 0x00008000 to 0x00008fff...
Flash will be erased from 0x00010000 to 0x0012ffff...
Compressed 20240 bytes to 12345...
Writing at 0x00000000... (100 %)
Wrote 20240 bytes (12345 compressed) at 0x00000000
...
Hash of data verified.

Leaving...
Hard resetting via RTS pin...
```

---

### 5. idf.py monitor

**å‘ç”Ÿçš„äº‹æƒ…**ï¼š

```bash
$ idf.py monitor

1. æ‰“å¼€ä¸²å£è¿æ¥
   - æ³¢ç‰¹ç‡: 115200ï¼ˆé»˜è®¤ï¼‰
   - æ•°æ®ä½: 8
   - åœæ­¢ä½: 1
   - æ ¡éªŒ: None

2. è¯»å–å¹¶æ˜¾ç¤ºè¾“å‡º
   - å½©è‰²æ—¥å¿—æ˜¾ç¤º
   - è‡ªåŠ¨è§£æå †æ ˆè·Ÿè¸ª
   - å°†åœ°å€è½¬æ¢ä¸ºå‡½æ•°å

3. æ”¯æŒå¿«æ·é”®
   Ctrl+] : é€€å‡º
   Ctrl+T Ctrl+R : é‡å¯ESP32
   Ctrl+T Ctrl+H : æ˜¾ç¤ºå¸®åŠ©
```

**è¾“å‡ºç¤ºä¾‹**ï¼š

```
--- idf_monitor on /dev/ttyUSB0 115200 ---
--- Quit: Ctrl+] | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H ---
ESP-ROM:esp32s3-20210327
Build:Mar 27 2021
rst:0x1 (POWERON),boot:0x8 (SPI_FAST_FLASH_BOOT)
...
I (340) cpu_start: Starting scheduler on PRO CPU.
I (0) cpu_start: Starting scheduler on APP CPU.
I (350) wifi:wifi driver task: 3ffc08b4, prio:23, stack:6656, core=0
I (350) system_api: Base MAC address is not set
I (350) system_api: read default base MAC address from EFUSE
```

---

## æ„å»ºè¿‡ç¨‹å¯è§†åŒ–

### æ–‡ä»¶ä¾èµ–å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CMakeLists.txt â”‚  é¡¹ç›®æ ¹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                     â”‚
         â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ main/           â”‚   â”‚ components/      â”‚
â”‚ CMakeLists.txt  â”‚   â”‚ my_component/    â”‚
â”‚ app_main.cpp    â”‚   â”‚ CMakeLists.txt   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  ESP-IDF ç»„ä»¶        â”‚
         â”‚  - esp_wifi          â”‚
         â”‚  - freertos          â”‚
         â”‚  - nvs_flash         â”‚
         â”‚  - esp_http_server   â”‚
         â”‚  - ...               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  ç¼–è¯‘ â†’ é“¾æ¥         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  .elf â†’ .bin         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### å†…å­˜å¸ƒå±€å›¾

**Flashå¸ƒå±€**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 0x0
â”‚  Bootloader (20KB)                      â”‚
â”‚  - åˆå§‹åŒ–ç¡¬ä»¶                            â”‚
â”‚  - åŠ è½½åˆ†åŒºè¡¨                            â”‚
â”‚  - å¯åŠ¨åº”ç”¨ç¨‹åº                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 0x8000
â”‚  Partition Table (4KB)                  â”‚
â”‚  - å®šä¹‰Flashåˆ†åŒº                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 0x9000
â”‚  NVS (Non-Volatile Storage) (24KB)      â”‚
â”‚  - WiFié…ç½®                             â”‚
â”‚  - åº”ç”¨æ•°æ®                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 0xF000
â”‚  PHY Init Data (4KB)                    â”‚
â”‚  - WiFi/BTæ ¡å‡†æ•°æ®                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ 0x10000
â”‚  Application (Factory)                  â”‚
â”‚  - ä½ çš„ç¨‹åºä»£ç                           â”‚
â”‚  - é™æ€æ•°æ®                              â”‚
â”‚  - åµŒå…¥çš„èµ„æº                            â”‚
â”‚  - å¤§å°: å‡ ç™¾KBåˆ°å‡ MB                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  OTA Data (å¯é€‰)                        â”‚
â”‚  - OTAå‡çº§çŠ¶æ€                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  OTA App 0/1 (å¯é€‰)                     â”‚
â”‚  - OTAå‡çº§ç”¨                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  SPIFFS / FAT (å¯é€‰)                    â”‚
â”‚  - æ–‡ä»¶ç³»ç»Ÿ                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ 8MB
```

**RAMå¸ƒå±€ï¼ˆè¿è¡Œæ—¶ï¼‰**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 0x3FC88000
â”‚  DRAM (å†…éƒ¨SRAM)                        â”‚
â”‚  - é™æ€å˜é‡                              â”‚
â”‚  - å †å†…å­˜                                â”‚
â”‚  - ä»»åŠ¡æ ˆ                                â”‚
â”‚  å¤§å°: ~400KB (ESP32-S3)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  IRAM (æŒ‡ä»¤RAM)                         â”‚
â”‚  - å…³é”®å‡½æ•°ä»£ç                           â”‚
â”‚  - ä¸­æ–­å¤„ç†ç¨‹åº                          â”‚
â”‚  å¤§å°: ~64KB                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  RTC Fast Memory                        â”‚
â”‚  - Deep Sleepä¿ç•™æ•°æ®                    â”‚
â”‚  å¤§å°: 8KB                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å¤–éƒ¨PSRAM (å¦‚æœå¯ç”¨)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” 0x3C000000
â”‚  PSRAM                                  â”‚
â”‚  - å¤§é‡æ•°æ®ç¼“å†²åŒº                        â”‚
â”‚  - å›¾åƒç¼“å†²åŒº                            â”‚
â”‚  - æ¨¡å‹æƒé‡                              â”‚
â”‚  å¤§å°: 2MB ~ 8MB                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é«˜çº§æŠ€å·§

### 1. å¢é‡ç¼–è¯‘

```bash
# åªç¼–è¯‘ä¿®æ”¹çš„æ–‡ä»¶
idf.py build

# å¦‚æœé‡åˆ°é—®é¢˜ï¼Œæ¸…ç†åé‡æ–°ç¼–è¯‘
idf.py fullclean
idf.py build
```

### 2. æŸ¥çœ‹ç¼–è¯‘å¤§å°

```bash
idf.py size

# è¾“å‡ºç¤ºä¾‹ï¼š
Total sizes:
 DRAM .data size:   12345 bytes
 DRAM .bss  size:   23456 bytes
Used static DRAM:   35801 bytes ( 144935 available)
Used static IRAM:   67890 bytes (  63246 available)
      Flash code:  234567 bytes
    Flash rodata:   45678 bytes
Total image size: ~383936 bytes (.bin may be padded larger)
```

### 3. æŸ¥çœ‹åˆ†åŒºä½¿ç”¨æƒ…å†µ

```bash
idf.py partition-table

# è¾“å‡ºç¤ºä¾‹ï¼š
# Name,             Type, SubType, Offset,  Size,     Flags
nvs,                data, nvs,     0x9000,  0x6000,
phy_init,           data, phy,     0xf000,  0x1000,
factory,            app,  factory, 0x10000, 0x100000,
```

### 4. å¹¶è¡Œç¼–è¯‘

```bash
# ä½¿ç”¨æ‰€æœ‰CPUæ ¸å¿ƒ
idf.py -jN build

# ä¾‹å¦‚ï¼š8æ ¸å¿ƒ
idf.py -j8 build
```

---

## æ€»ç»“

### å…³é”®ç‚¹

1. **é¡¹ç›®ç»“æ„ç®€å•** - æœ€å°‘åªéœ€è¦3ä¸ªæ–‡ä»¶
2. **buildç›®å½•è‡ªåŠ¨ç”Ÿæˆ** - å¯ä»¥éšæ—¶åˆ é™¤é‡å»º
3. **sdkconfigç®¡ç†é…ç½®** - menuconfigä¿®æ”¹é…ç½®
4. **CMakeé©±åŠ¨æ„å»º** - è‡ªåŠ¨å¤„ç†ä¾èµ–
5. **åˆ†é˜¶æ®µç¼–è¯‘** - bootloader â†’ åˆ†åŒºè¡¨ â†’ ç»„ä»¶ â†’ é“¾æ¥

### æ¨èå·¥ä½œæµ

```bash
# æ–°é¡¹ç›®
idf.py set-target esp32s3
idf.py menuconfig  # é…ç½®é€‰é¡¹
idf.py build flash monitor

# æ—¥å¸¸å¼€å‘
# ä¿®æ”¹ä»£ç ...
idf.py build flash monitor

# é‡åˆ°é—®é¢˜
idf.py fullclean
idf.py build flash monitor
```

---

è¿™å°±æ˜¯ESP32é¡¹ç›®ä»é›¶åˆ°è¿è¡Œçš„å®Œæ•´è¿‡ç¨‹ï¼ğŸ‰
